<!DOCTYPE html>
<html lang="en" class="h-100" data-bs-theme="auto">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="color-scheme" content="dark light" />
  <meta name="description" content="Easily allow users to install cydWeeWX firmware from their browser." />
  <title>cydWeeWX installer</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@docsearch/css@3">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
  <script type="module" src="https://unpkg.com/esp-web-tools@10/dist/web/install-button.js?module"></script>
  <style>
    .flash-container {
      @include make-container();
      width: 640px;
    }
  </style>
</head>

<body class="d-flex text-center text-bg-dark bg-dark">
  <div class="flash-container m-auto">
    <h1 class="pt-3">cydWeeWX Installer</h1>
    <p class="fw-medium fs-5 text-start">This is an installer for the cydWeeWX Weather Display. For the latest
      information about cydWeeWX,
      as well as how to configure both the device and WeeWX, see the <a href="https://github.com/hcomet/cydWeeWX"
        class="link-light" target="_blank">cydWeeWX GitHub repository</a>.
    </p>
    <p class="fw-medium fs-5 text-start">cydWeeWX was developed for the <a
        href="https://github.com/witnessmenow/ESP32-Cheap-Yellow-Display" class="link-light"
        target="_blank">ESP32-Cheap-Yellow-Display</a>, or CYD, which provides a 320 x 240 2.8" LCD display with a touch
      screen and embedded ESP32. There are <a
        href="https://github.com/witnessmenow/ESP32-Cheap-Yellow-Display/blob/main/cyd.md" class="link-light"
        target="_blank">two versions of the CYD</a>. The original CYD only has a single micro USB port while there is
      newer CYD
      that has two USB ports, one micro USB and one
      USB-C.
    </p>
    <p class="fw-medium fs-5 text-start">Connect your CYD to your computer via USB, select the type of CYD below, then
      click the
      <strong>Connect</strong> button to install.
    </p>

    <div class="container w-75 m-a">
      <div class="form-check fw-medium fs-5 text-start ms-5">
        <input class="form-check-input" type="radio" name="type" value="cyd2usb" id="cyd2usb" />
        <label class="form-check-label" for="cyd2usb">CYD2USB - two usb connectors</label>
      </div>
      <div class="form-check fw-medium fs-5 text-start ms-5">
        <input class="form-check-input" type="radio" name="type" value="cyd" id="cyd" />
        <label class="form-check-label" for="cyd">CYD - single micro usb connector</label>
      </div>

      <esp-web-install-button class="invisible">
        <button type="button" class="btn btn-primary mt-3" slot="activate">Connect</button>
      </esp-web-install-button>
    </div>
    <p class="fw-medium fs-5 text-start text-warning mt-3"><strong>NOTE:</strong> Click the <em>Erase device</em>
      checkbox, when presented, if this is an initial install. DO NOT click the checkbox if you want to
      keep your cydWeeWX WiFi and WeeWX Server settings.</p>

    <footer class="mt-auto text-white">
      <p>
        cydWeeWX by <a href="https://github.com/hcomet" class="link-light">hcomet</a> &mdash;
        Installer powered by <a href="https://esphome.github.io/esp-web-tools/" class="link-light">ESP Web Tools</a>.
      </p>
    </footer>
</body>
<script>
  document.querySelectorAll('input[name="type"]').forEach(radio =>
    radio.addEventListener("change", () => {
      const button = document.querySelector('esp-web-install-button');
      button.manifest = `./manifest_${radio.value}.json`;
      button.classList.remove('invisible');
    }
    ));
</script>

</html>